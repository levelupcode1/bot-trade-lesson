# 전략 구현 및 백테스팅 실습 평가

## 실습 개요
본 실습은 Cursor AI를 활용하여 암호화폐 자동매매 전략을 구현하고 백테스팅을 통해 성과를 평가하는 능력을 평가합니다. 변동성 돌파 전략의 핵심 로직 구현, 성과 지표 계산, 필터링 기법 적용 등의 핵심 기능을 구현합니다.

---

## 문항 4: 변동성 돌파 전략의 돌파선 계산 함수 개발

### 문제 조건

Cursor AI를 활용하여 변동성 돌파 전략의 돌파선 계산 함수를 개발하시오.

#### 필수 요구사항
1. **함수명**: `calculate_breakout_price`
2. **입력 파라미터**:
   - `high` (float): 전일 고가
   - `low` (float): 전일 저가
   - `k` (float): K값
   - `current_price` (float): 현재가
3. **돌파선 계산 공식**: 
   ```
   target_price = high + (high - low) × k
   ```
4. **매수 신호 판단**: 
   - 현재가가 돌파선을 상향 돌파했는지 판단
   - `current_price > target_price`일 때 매수 신호
5. **반환값**: 
   - (target_price, buy_signal) 튜플 형태
   - buy_signal은 True/False
6. **입력값 검증**:
   - high > low 조건 확인
   - K값 범위: 0 < k < 1
7. **코드 품질**: 
   - 타입 힌트 포함
   - docstring 포함
   - 예외 처리 포함

#### Cursor AI 프롬프트 작성 조건
다음 필수 키워드를 포함해야 함:
- "함수"
- "계산"
- "검증"
- "타입 힌트"
- "docstring"
- "예외 처리"
- "반환값"

프롬프트에는 다음을 구체적으로 명시:
- 함수명
- 입력 파라미터 타입
- 계산 공식
- 반환값 구조 (돌파선 값, 매수 신호)
- 입력값 검증 조건

### 정답 기준

#### 1. Cursor AI 프롬프트 작성 및 필수 키워드 포함 (25점)
**예시 프롬프트:**
```
변동성 돌파 전략의 돌파선을 계산하는 함수를 만들어줘. 
함수명은 calculate_breakout_price, 
입력: high(float), low(float), k(float), current_price(float), 
돌파선 계산 공식: target_price = high + (high - low) * k, 
현재가와 비교하여 매수 신호 판단(current_price > target_price), 
반환값은 (target_price, buy_signal) 튜플, 
입력값 검증(high > low, 0 < k < 1), 
타입 힌트와 docstring 포함, 
예외 처리 포함
```

**채점 기준:**
- 필수 키워드 모두 포함 (15점)
- 함수명, 파라미터 타입, 계산 공식, 반환값 구조, 검증 조건 명시 (10점)

#### 2. 돌파선 계산 공식 구현 (30점)
- 공식 정확히 구현: `target_price = high + (high - low) * k` (20점)
- 계산 로직의 정확성 (10점)

#### 3. 현재가와 돌파선 비교 로직 및 매수 신호 판단 (25점)
- 현재가와 돌파선 비교: `current_price > target_price` (15점)
- 매수 신호(True/False) 정확히 반환 (10점)

#### 4. 입력값 검증 및 예외 처리 (20점)
- high > low 조건 검증 (10점)
- K값 범위 검증 (0 < k < 1) (5점)
- 예외 처리 구현 (5점)

### 해설
Cursor AI를 활용하여 변동성 돌파 전략의 핵심 로직인 돌파선 계산과 매수 신호 판단 능력을 평가합니다. 이는 추세 추종 전략의 기본이 되는 중요한 개념입니다. 프롬프트 작성 능력도 함께 평가합니다.

---

## 문항 5: 백테스팅 시스템의 성과 지표 계산 함수 개발

### 문제 조건

Cursor AI를 활용하여 백테스팅 시스템의 성과 지표 계산 함수를 개발하시오.

#### 필수 요구사항
1. **함수명**: `calculate_performance_metrics`
2. **입력 데이터 구조**:
   ```python
   trades = [
       {
           'date': '2024-01-01',
           'buy_price': 50000.0,
           'sell_price': 52000.0,
           'quantity': 1.0
       },
       # ... 더 많은 거래 내역
   ]
   ```
3. **계산할 지표**:
   - 총 수익률 (Total Return)
   - 승률 (Win Rate)
   - 최대 낙폭 (MDD: Maximum Drawdown)
   - 샤프 비율 (Sharpe Ratio)
4. **각 지표 계산 공식**:
   - **총 수익률**: `(최종 자산 - 초기 자산) / 초기 자산 × 100`
   - **승률**: `수익 거래 수 / 전체 거래 수 × 100`
   - **MDD**: 누적 수익률의 최고점과 최저점 차이
   - **샤프 비율**: `(평균 수익률 - 무위험 수익률) / 수익률 표준편차`
5. **반환값**: 
   ```python
   {
       'total_return': float,
       'win_rate': float,
       'mdd': float,
       'sharpe_ratio': float
   }
   ```
6. **코드 품질**: 
   - 타입 힌트 포함
   - docstring 포함
   - numpy 사용 가능

#### Cursor AI 프롬프트 작성 조건
다음 필수 키워드를 포함해야 함:
- "함수"
- "계산"
- "리스트"
- "딕셔너리"
- "반복문"
- "조건문"
- "수학 연산"
- "통계"
- "타입 힌트"
- "docstring"

프롬프트에는 다음을 구체적으로 명시:
- 입력 데이터 구조
- 각 지표의 계산 공식
- 반환값 구조

### 정답 기준

#### 1. Cursor AI 프롬프트 작성 및 필수 키워드 포함 (25점)
**예시 프롬프트:**
```
백테스팅 성과 지표를 계산하는 함수를 만들어줘. 
함수명은 calculate_performance_metrics, 
입력: trades 리스트(각 거래는 {'date', 'buy_price', 'sell_price', 'quantity'}), 
총 수익률 계산: (최종 자산 - 초기 자산) / 초기 자산 * 100, 
승률: 수익 거래 수 / 전체 거래 수 * 100, 
MDD: 누적 수익률의 최고점과 최저점 차이, 
샤프 비율: (평균 수익률 - 무위험 수익률) / 수익률 표준편차, 
반환값은 딕셔너리 {'total_return', 'win_rate', 'mdd', 'sharpe_ratio'}, 
numpy 사용 가능, 
타입 힌트와 docstring 포함
```

**채점 기준:**
- 필수 키워드 모두 포함 (15점)
- 입력 데이터 구조, 계산 공식, 반환값 구조 명시 (10점)

#### 2. 총 수익률 및 승률 계산 (25점)
- 총 수익률 계산: `(최종 자산 - 초기 자산) / 초기 자산 × 100` (12점)
- 승률 계산: `수익 거래 수 / 전체 거래 수 × 100` (13점)

#### 3. MDD 계산 (25점)
- 누적 수익률 계산 (10점)
- 최고점과 최저점 차이 계산 (15점)

#### 4. 샤프 비율 계산 및 각 지표 의미 설명 (25점)
- 샤프 비율 계산: `(평균 수익률 - 무위험 수익률) / 수익률 표준편차` (15점)
- 각 지표의 의미 설명 (10점)

### 해설
Cursor AI를 활용하여 백테스팅을 통해 전략의 성과를 정량적으로 평가하는 능력을 평가합니다. 수익률뿐만 아니라 리스크 지표를 함께 고려하는 것이 중요합니다. 프롬프트 작성 능력도 함께 평가합니다.

---

## 문항 6: 변동성 돌파 전략 필터링 기법 구현

### 문제 조건

Cursor AI를 활용하여 변동성 돌파 전략에서 가짜 돌파를 줄이기 위한 필터링 기법 3가지를 구현하시오.

#### 필수 요구사항
1. **필터링 기법 3가지**:
   - 변동성 필터
   - 시간대 필터
   - 확인 캔들 필터
2. **각 필터 함수 요구사항**:
   - **변동성 필터 함수**:
     - 함수명: `volatility_filter`
     - 입력: `current_volatility` (float), `avg_volatility` (float)
     - 반환: `bool`
     - 로직: 전일 변동폭이 최근 N일 평균 변동폭보다 큰지 확인
   - **시간대 필터 함수**:
     - 함수명: `time_filter`
     - 입력: `current_hour` (int), `start_hour` (int), `end_hour` (int)
     - 반환: `bool`
     - 로직: 현재 시간이 지정된 시간대(9시~18시) 내인지 확인
   - **확인 캔들 필터 함수**:
     - 함수명: `confirmation_candle_filter`
     - 입력: `current_price` (float), `breakout_price` (float), `prev_price` (float)
     - 반환: `bool`
     - 로직: 돌파 후 다음 캔들에서도 돌파선 위에 유지되는지 확인
3. **코드 품질**: 
   - 타입 힌트 포함
   - docstring 포함
4. **설명 요구사항**:
   - 각 기법의 적용 방법 설명
   - 각 기법의 효과 설명

#### Cursor AI 프롬프트 작성 조건
다음 필수 키워드를 포함해야 함:
- "함수"
- "필터"
- "조건문"
- "검증"
- "로직"
- "타입 힌트"
- "docstring"

프롬프트에는 다음을 구체적으로 명시:
- 각 필터의 적용 조건
- 입력 파라미터
- 반환값

### 정답 기준

#### 1. Cursor AI 프롬프트 작성 및 필수 키워드 포함 (30점)
**예시 프롬프트:**
```
변동성 돌파 전략의 필터링 함수 3개를 만들어줘. 
1) 변동성 필터 함수: 전일 변동폭이 최근 N일 평균 변동폭보다 큰지 확인, 
   입력: current_volatility, avg_volatility, 반환: bool, 
2) 시간대 필터 함수: 현재 시간이 지정된 시간대(9시~18시) 내인지 확인, 
   입력: current_hour, start_hour, end_hour, 반환: bool, 
3) 확인 캔들 필터 함수: 돌파 후 다음 캔들에서도 돌파선 위에 유지되는지 확인, 
   입력: current_price, breakout_price, prev_price, 반환: bool, 
각 함수에 타입 힌트와 docstring 포함
```

**채점 기준:**
- 필수 키워드 모두 포함 (18점)
- 각 필터의 적용 조건, 입력 파라미터, 반환값 명시 (12점)

#### 2. 변동성 필터 설명 및 구현 (25점)
- 변동성 필터 로직 설명: 전일 변동폭이 최근 N일 평균 변동폭보다 큰 경우만 거래 (10점)
- 함수 구현 정확성 (15점)

#### 3. 시간대 필터 설명 및 구현 (25점)
- 시간대 필터 로직 설명: 특정 시간대(예: 오전 9시~오후 6시)에만 거래 실행 (10점)
- 함수 구현 정확성 (15점)

#### 4. 확인 캔들 조건 설명 및 구현 (20점)
- 확인 캔들 조건 설명: 돌파 후 다음 캔들에서도 돌파선 위에 유지되는지 확인 (10점)
- 함수 구현 정확성 (10점)

### 해설
Cursor AI를 활용하여 가짜 돌파 신호를 필터링하여 승률을 향상시키는 방법을 이해하고 있는지 평가합니다. 실제 거래에서 승률 향상은 매우 중요한 요소입니다. 프롬프트 작성 능력도 함께 평가합니다.

---

## 문항 출제 목표
- Cursor AI를 활용한 개발 능력 평가
- 프롬프트 작성 능력 평가
- 변동성 돌파 전략의 핵심 로직 이해 및 구현 능력 평가
- 백테스팅 성과 지표 계산 능력 평가
- 리스크 관리 이해도 평가
- 전략 개선을 위한 필터링 기법 이해 및 적용 능력 평가

## 총 배점
- 문항 4: 100점
- 문항 5: 100점
- 문항 6: 100점
- **총점: 300점**
