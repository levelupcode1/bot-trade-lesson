# 시스템 통합 및 운영 실습 평가

## 실습 개요
본 실습은 Cursor AI를 활용하여 자동매매 시스템의 핵심 모듈을 설계하고 구현하는 능력을 평가합니다. 리스크 관리, 모니터링 인터페이스, 오류 처리 및 복구 메커니즘 등의 핵심 기능을 구현합니다.

---

## 문항 7: 자동매매 시스템의 리스크 관리 모듈 개발

### 문제 조건

Cursor AI를 활용하여 자동매매 시스템의 리스크 관리 모듈을 개발하시오.

#### 필수 요구사항
1. **클래스명**: `RiskManager`
2. **초기화 파라미터**:
   - `daily_loss_limit` (float): 일일 손실 한도
   - `max_position_size_ratio` (float): 최대 포지션 크기 비율 (예: 0.2 = 총 자산의 20%)
   - `stop_loss_ratio` (float): 손절 비율 (예: -0.02 = -2%)
   - `take_profit_ratio` (float): 익절 비율 (예: 0.05 = +5%)
3. **필수 메서드**:
   - `check_daily_loss(accumulated_loss: float) -> bool`: 
     - 누적 손실 확인
     - 일일 손실 한도 초과 시 False 반환
   - `check_position_size(position_size: float, total_asset: float) -> bool`: 
     - 포지션 크기 확인
     - 최대 포지션 크기 비율 초과 시 False 반환
   - `check_stop_loss_take_profit(entry_price: float, current_price: float) -> tuple[bool, str]`: 
     - 손절/익절 확인
     - 손절 또는 익절 조건 달성 시 (True, 'stop_loss' 또는 'take_profit') 반환
4. **상태 관리**:
   - `is_trading_allowed` 플래그 관리
   - 제한 초과 시 거래 중단
5. **추가 기능**:
   - 로깅 기능 포함
   - 알림 기능 포함
6. **코드 품질**: 
   - 타입 힌트 포함
   - docstring 포함
   - 예외 처리 포함

#### Cursor AI 프롬프트 작성 조건
다음 필수 키워드를 포함해야 함:
- "클래스"
- "메서드"
- "상태 관리"
- "검증"
- "로깅"
- "알림"
- "예외 처리"
- "타입 힌트"

프롬프트에는 다음을 구체적으로 명시:
- 클래스 구조
- 각 제한값 설정 방법
- 제한 초과 시 처리 로직
- 상태 관리 방법

### 정답 기준

#### 1. Cursor AI 프롬프트 작성 및 필수 키워드 포함 (25점)
**예시 프롬프트:**
```
자동매매 시스템의 리스크 관리 클래스를 만들어줘. 
클래스명은 RiskManager, 
초기화: daily_loss_limit, max_position_size_ratio, stop_loss_ratio, take_profit_ratio, 
메서드: check_daily_loss(누적 손실 확인), check_position_size(포지션 크기 확인), check_stop_loss_take_profit(손절/익절 확인), 
각 메서드는 제한 초과 시 False 반환, 
거래 중단 플래그(is_trading_allowed) 관리, 
로깅 및 알림 기능 포함, 
타입 힌트와 docstring 포함
```

**채점 기준:**
- 필수 키워드 모두 포함 (15점)
- 클래스 구조, 제한값 설정, 처리 로직, 상태 관리 명시 (10점)

#### 2. 일일 손실 한도 관리 (25점)
- 누적 손실 추적 (10점)
- 일일 손실 한도 초과 시 거래 중단 로직 (10점)
- check_daily_loss 메서드 구현 (5점)

#### 3. 포지션 크기 제한 (25점)
- 최대 투자 가능 금액 계산 (총 자산의 비율) (10점)
- 포지션 크기 검증 로직 (10점)
- check_position_size 메서드 구현 (5점)

#### 4. 손절/익절 비율 설정 및 제한 초과 시 거래 중단 로직 (25점)
- 손절/익절 비율 설정 (진입가 대비 손절 -2%, 익절 +5%) (10점)
- check_stop_loss_take_profit 메서드 구현 (10점)
- 제한 초과 시 거래 중단 플래그 설정 및 알림 (5점)

### 해설
Cursor AI를 활용하여 자동매매 시스템의 안정성을 보장하는 리스크 관리 능력을 평가합니다. 실제 자금을 다루는 시스템에서 리스크 관리는 가장 중요한 요소입니다. 프롬프트 작성 능력도 함께 평가합니다.

---

## 문항 8: 텔레그램 봇 기반 자동매매 시스템 모니터링 인터페이스 개발

### 문제 조건

Cursor AI를 활용하여 텔레그램 봇 기반 자동매매 시스템 모니터링 인터페이스를 개발하시오.

#### 필수 요구사항
1. **라이브러리**: `python-telegram-bot` 사용
2. **모듈 구조**:
   - `handlers`: 명령어 처리 모듈
   - `templates`: 메시지 포맷팅 모듈
   - `config`: 설정 관리 모듈
3. **필수 명령어 핸들러**:
   - `/start`: 봇 시작 및 환영 메시지
   - `/status`: 시스템 상태 조회 (현재 포지션, 시스템 상태)
   - `/profit`: 수익률 조회
   - `/start_trading`: 거래 시작 명령
   - `/stop_trading`: 거래 중지 명령
4. **기술 요구사항**:
   - 각 핸들러는 `async` 함수
   - `@app.command` 데코레이터 사용
   - 템플릿 모듈로 응답 메시지 포맷팅
5. **추가 기능**:
   - 에러 처리
   - 로깅
   - 타입 힌트
6. **자동매매 시스템 연동**:
   - 자동매매 시스템과의 인터페이스 구현

#### Cursor AI 프롬프트 작성 조건
다음 필수 키워드를 포함해야 함:
- "클래스"
- "모듈"
- "핸들러"
- "데코레이터"
- "비동기"
- "에러 처리"
- "로깅"
- "타입 힌트"

프롬프트에는 다음을 구체적으로 명시:
- 모듈 구조
- 각 핸들러 함수
- 명령어 처리 방법
- 템플릿 사용 방법

### 정답 기준

#### 1. Cursor AI 프롬프트 작성 및 필수 키워드 포함 (25점)
**예시 프롬프트:**
```
텔레그램 봇을 활용한 자동매매 모니터링 시스템을 만들어줘. 
python-telegram-bot 라이브러리 사용, 
모듈 구조: handlers(명령어 처리), templates(메시지 포맷팅), config(설정 관리), 
핸들러 함수: /start, /status, /profit, /start_trading, /stop_trading, 
각 핸들러는 async 함수, 
@app.command 데코레이터 사용, 
템플릿 모듈로 응답 메시지 포맷팅, 
에러 처리 및 로깅 포함, 
타입 힌트 포함
```

**채점 기준:**
- 필수 키워드 모두 포함 (15점)
- 모듈 구조, 핸들러 함수, 명령어 처리, 템플릿 사용 명시 (10점)

#### 2. 텔레그램 봇 기본 구조 및 명령어 핸들러 설계 (30점)
- python-telegram-bot 라이브러리 사용 (5점)
- 5개 핸들러 함수 모두 구현 (/start, /status, /profit, /start_trading, /stop_trading) (20점)
- async 함수 및 데코레이터 사용 (5점)

#### 3. 모듈화된 구조(핸들러, 템플릿, 설정 관리자) (30점)
- handlers 모듈: 명령어 처리 (10점)
- templates 모듈: 응답 메시지 포맷팅 (10점)
- config 모듈: 설정 관리 (10점)

#### 4. 자동매매 시스템 연동 인터페이스 및 에러 처리 (15점)
- 자동매매 시스템과의 연동 인터페이스 구현 (10점)
- 에러 처리 및 로깅 (5점)

### 해설
Cursor AI를 활용하여 텔레그램 봇을 통한 원격 모니터링 및 제어 시스템 설계 능력을 평가합니다. 실제 운영 환경에서 필수적인 기능입니다. 프롬프트 작성 능력도 함께 평가합니다.

---

## 문항 9: 자동매매 시스템의 오류 처리 및 복구 메커니즘 개발

### 문제 조건

Cursor AI를 활용하여 자동매매 시스템의 오류 처리 및 복구 메커니즘을 개발하시오.

#### 필수 요구사항
1. **클래스명**: `ErrorHandler`
2. **처리할 오류 유형**:
   - API 인증 오류
   - 네트워크 연결 오류
   - 데이터 오류
3. **각 오류 유형별 처리 메서드**:
   - `handle_auth_error()`: 
     - API 키 재확인
     - 토큰 재생성
     - 관리자 알림
   - `handle_network_error()`: 
     - 자동 재시도 (지수 백오프)
     - 최대 3회 재시도
     - 대체 API 엔드포인트 사용
   - `handle_data_error()`: 
     - 데이터 검증 로직
     - 이전 정상 데이터 사용
     - 알림 전송
4. **로깅 시스템**:
   - 오류 유형 기록
   - 발생 시간 기록
   - 재시도 횟수 기록
   - logging 모듈 사용
5. **알림 시스템**:
   - 텔레그램 또는 이메일로 즉시 알림
6. **코드 품질**: 
   - 예외 처리 포함
   - 타입 힌트 포함

#### Cursor AI 프롬프트 작성 조건
다음 필수 키워드를 포함해야 함:
- "클래스"
- "예외 처리"
- "재시도"
- "로깅"
- "알림"
- "상태 관리"
- "백오프"
- "검증"
- "타입 힌트"

프롬프트에는 다음을 구체적으로 명시:
- 각 오류 유형별 처리 방법
- 재시도 로직
- 로깅 형식
- 알림 전송 방법

### 정답 기준

#### 1. Cursor AI 프롬프트 작성 및 필수 키워드 포함 (25점)
**예시 프롬프트:**
```
자동매매 시스템의 오류 처리 및 복구 클래스를 만들어줘. 
클래스명은 ErrorHandler, 
메서드: handle_auth_error(API 키 재확인, 토큰 재생성), 
handle_network_error(지수 백오프 재시도, 최대 3회), 
handle_data_error(데이터 검증, 이전 정상 데이터 사용), 
각 메서드는 자동 복구 시도, 
logging 모듈로 오류 기록(오류 유형, 시간, 재시도 횟수), 
알림 전송 기능(텔레그램 또는 이메일), 
예외 처리 및 타입 힌트 포함
```

**채점 기준:**
- 필수 키워드 모두 포함 (15점)
- 오류 유형별 처리 방법, 재시도 로직, 로깅 형식, 알림 전송 명시 (10점)

#### 2. API 인증 오류 대응 방안 (20점)
- API 키 재확인 로직 (7점)
- 토큰 재생성 로직 (7점)
- 관리자 알림 기능 (6점)

#### 3. 네트워크 연결 오류 대응 방안 (20점)
- 자동 재시도 로직 (지수 백오프) (10점)
- 최대 3회 재시도 제한 (5점)
- 대체 API 엔드포인트 사용 (5점)

#### 4. 데이터 오류 대응 방안 (15점)
- 데이터 검증 로직 (5점)
- 이전 정상 데이터 사용 (5점)
- 알림 전송 (5점)

#### 5. 로깅 및 알림 시스템 (20점)
- 로깅 시스템: 오류 유형, 발생 시간, 재시도 횟수 기록 (10점)
- 알림 시스템: 텔레그램 또는 이메일로 즉시 알림 (10점)

### 해설
Cursor AI를 활용하여 실제 운영 환경에서 발생할 수 있는 다양한 오류 상황에 대한 대응 능력과 자동 복구 시스템 설계 능력을 평가합니다. 프롬프트 작성 능력도 함께 평가합니다.

---

## 문항 출제 목표
- Cursor AI를 활용한 개발 능력 평가
- 프롬프트 작성 능력 평가
- 리스크 관리 시스템 설계 능력 평가
- 안전한 자동매매 운영 이해도 평가
- 텔레그램 봇을 활용한 모니터링 시스템 설계 및 모듈화 능력 평가
- 오류 처리 및 자동 복구 시스템 설계 능력 평가

## 총 배점
- 문항 7: 100점
- 문항 8: 100점
- 문항 9: 100점
- **총점: 300점**
